<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
    <th:block th:replace="~{fragments/head :: head-content(
        pageTitle='Logowanie | CzyZlowie',
        pageDescription='Zaloguj się do swojego konta wędkarskiego i uzyskaj dostęp do spersonalizowanych prognoz brań.'
    )}"></th:block>

    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/auth.css}">
    <script src="https://unpkg.com/lucide@latest" defer></script>
</head>
<body class="auth-page">

<nav th:replace="~{fragments/navbar :: navbar}"></nav>

<main class="auth-wrapper">
    <picture class="auth-bg-picture">
        <source media="(max-width: 768px)" srcset="/assets/ryby/predators-bg.jpg">
        <img src="/assets/predators.jpg" alt="Podwodny świat drapieżników" class="auth-bg-image">
    </picture>
    <div class="auth-bg-overlay"></div>

    <div class="container-xl d-flex justify-content-center align-items-center min-vh-100 py-5 position-relative z-2" style="margin-top: 30px;">

        <div class="auth-card glass-panel w-100">
            <div class="row g-0">

                <div class="col-lg-6 auth-form-section pe-lg-5 mb-5 mb-lg-0">

                    <div class="text-center text-lg-start mb-4">

                        <a class="d-none d-lg-block" th:href="@{/}">
                            <img src="/assets/logo.png" alt="CzyZlowie Logo" class="auth-logo mb-4">
                        </a>
                        <h1 class="auth-title">Witaj z powrotem!</h1>
                        <p class="auth-subtitle">Zaloguj się, aby sprawdzić dzisiejszą prognozę brań.</p>
                    </div>

                    <div th:if="${param.error}" class="alert auth-alert alert-danger d-flex align-items-center gap-2">
                        <i data-lucide="shield-alert" style="width: 20px;"></i>
                        <span>Nieprawidłowy e-mail lub hasło.</span>
                    </div>
                    <div th:if="${param.logout}" class="alert auth-alert alert-success d-flex align-items-center gap-2">
                        <i data-lucide="check-circle" style="width: 20px;"></i>
                        <span>Zostałeś pomyślnie wylogowany.</span>
                    </div>

                    <form th:action="@{/login}" method="post" class="auth-form mt-4">

                        <div class="form-group mb-3">
                            <label for="username" class="form-label text-white-50 fs-7 fw-bold text-uppercase mb-2">Adres E-mail</label>
                            <div class="input-icon-wrapper">
                                <i data-lucide="mail" class="input-icon"></i>
                                <input type="email" id="username" name="username" class="form-control auth-input" placeholder="wedkarz@pzw.pl" required autofocus>
                            </div>
                        </div>

                        <div class="form-group mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <label for="password" class="form-label text-white-50 fs-7 fw-bold text-uppercase mb-0">Hasło</label>
                                <a th:href="@{/zapomnialem-hasla}" class="auth-link fs-7">Zapomniałeś hasła?</a>
                            </div>
                            <div class="input-icon-wrapper">
                                <i data-lucide="lock" class="input-icon"></i>
                                <input type="password" id="password" name="password" class="form-control auth-input" placeholder="••••••••" required>
                                <button type="button" class="btn-toggle-pass" aria-label="Pokaż hasło">
                                    <i data-lucide="eye" style="width: 18px;"></i>
                                </button>
                            </div>
                        </div>

                        <div class="form-check custom-checkbox mb-4">
                            <input type="checkbox" class="form-check-input" id="remember-me" name="remember-me">
                            <label class="form-check-label text-white-50" for="remember-me">Zapamiętaj mnie na tym urządzeniu</label>
                        </div>

                        <button type="submit" class="btn btn-auth-primary w-100 position-relative overflow-hidden">
                            <span class="position-relative z-1 d-flex align-items-center justify-content-center">
                                ZALOGUJ SIĘ <i data-lucide="arrow-right" class="ms-2" style="width: 20px;"></i>
                            </span>
                            <div class="btn-shine"></div>
                        </button>
                    </form>

                    <div class="auth-footer mt-4 text-center text-lg-start">
                        <span class="text-white-50">Nie masz jeszcze konta?</span>
                        <a th:href="@{/rejestracja}" class="auth-link fw-bold ms-1">Zarejestruj się za darmo</a>
                    </div>
                </div>

                <div class="col-auto d-none d-lg-flex flex-column align-items-center justify-content-center px-4 mt-5 mt-lg-0">
                    <div class="auth-divider-line"></div>
                    <div class="auth-divider-text">LUB</div>
                    <div class="auth-divider-line"></div>
                </div>

                <div class="col-12 d-lg-none my-4 position-relative text-center">
                    <hr class="auth-divider-mobile">
                    <span class="auth-divider-text-mobile">LUB ZALOGUJ PRZEZ</span>
                </div>

                <div class="col-lg ps-lg-4 d-flex flex-column justify-content-center">

                    <div class="social-login-wrapper mt-3 mt-lg-0">
                        <h4 class="social-title d-none d-lg-block mb-4 text-center text-lg-start">Szybkie logowanie</h4>

                        <a th:href="@{/oauth2/authorization/google}" class="btn btn-social btn-google mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48"><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"/><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"/><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.654-3.343-11.303-8l-6.571,4.819C9.656,39.663,16.318,44,24,44z"/><path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"/></svg>
                            <span>Kontynuuj z Google</span>
                        </a>

                        <a th:href="@{/oauth2/authorization/facebook}" class="btn btn-social btn-facebook mb-3">
                            <i class="bi bi-facebook fs-5"></i>
                            <span>Kontynuuj z Facebook</span>
                        </a>

                        <a th:href="@{/oauth2/authorization/apple}" class="btn btn-social btn-apple">
                            <i class="bi bi-apple fs-5"></i>
                            <span>Kontynuuj z Apple</span>
                        </a>
                    </div>

                    <div class="mt-auto pt-5 d-none d-lg-block text-center">
                        <i data-lucide="shield-check" class="text-brand-green mb-2" style="width: 42px; height: 42px;"></i>
                        <p class="fs-7 mb-0 text-white" style="font-weight: 500; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
                            Twoje dane są w <strong class="text-brand-green">100% bezpieczne</strong>.<br>Nie publikujemy niczego bez Twojej zgody.
                        </p>
                    </div>
                </div>

            </div>
        </div>
    </div>
</main>

<footer th:replace="~{fragments/footer :: footer}"></footer>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        lucide.createIcons();

        const togglePassBtn = document.querySelector('.btn-toggle-pass');
        const passInput = document.getElementById('password');

        if(togglePassBtn && passInput) {
            togglePassBtn.addEventListener('click', () => {
                const type = passInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passInput.setAttribute('type', type);

                const icon = togglePassBtn.querySelector('i');
                if(type === 'text') {
                    icon.setAttribute('data-lucide', 'eye-off');
                } else {
                    icon.setAttribute('data-lucide', 'eye');
                }
                lucide.createIcons();
            });
        }
    });
</script>
</body>
</html>