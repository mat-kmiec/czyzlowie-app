<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
    <th:block th:replace="~{fragments/head :: head-content(
        pageTitle='Kalendarz BraÅ„ i Fazy KsiÄ™Å¼yca - WÄ™dkarski Kalendarz Solunarny | CzyZlowie',
        pageDescription='SprawdÅº aktualny wÄ™dkarski kalendarz solunarny dla dowolnego Å‚owiska w Polsce. DokÅ‚adne fazy ksiÄ™Å¼yca, wschody, zachody i przewidywane okresy Å¼erowania ryb.'
    )}"></th:block>

    <link rel="stylesheet" th:href="@{/css/essentials/moon.css}">


</head>
<body class="moon-page">

<nav th:replace="~{fragments/navbar :: navbar}"></nav>

<div class="moon-bg-container">
    <div class="moon-bg-overlay"></div>
    <div class="moon-glow glow-silver-top"></div>
    <div class="moon-glow glow-green-bottom"></div>
</div>

<main class="moon-wrapper pb-5 position-relative z-2">
    <div class="container-xl pt-4 mt-3">

        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb moon-breadcrumb">
                <li class="breadcrumb-item"><a th:href="@{/}"><i data-lucide="home" class="bc-icon text-brand-green"></i> GÅ‚Ã³wna</a></li>
                <li class="breadcrumb-item"><a th:href="@{/niezbednik}">NiezbÄ™dnik</a></li>
                <li class="breadcrumb-item active fw-bold text-white" aria-current="page">Fazy KsiÄ™Å¼yca</li>
            </ol>
        </nav>

        <header class="moon-glass-panel p-4 p-lg-5 mb-4 border-brand-green-subtle">
            <div class="row align-items-center justify-content-between g-4">
                <div class="col-lg-8">
                    <div class="d-flex align-items-center gap-3 mb-3">
                        <div class="moon-icon-pulse fs-3" aria-hidden="true">
                            ğŸŒ™
                        </div>
                        <h1 class="display-5 fw-black text-white mb-0 moon-title-glow">WÄ™dkarski Kalendarz Solunarny</h1>
                    </div>
                    <p class="moon-text-readable fs-5 mb-0">
                        Wykorzystaj potÄ™Å¼ne dane o <span class="text-brand-green fw-bold text-glow-green">grawitacji KsiÄ™Å¼yca i SÅ‚oÅ„ca</span> do prognozowania szczytÃ³w aktywnoÅ›ci ryb. SprawdÅº, kiedy uderzyÄ‡ nad wodÄ™ z najwiÄ™kszÄ… skutecznoÅ›ciÄ….
                    </p>
                </div>
            </div>
        </header>

        <div class="row g-4 mb-4">

            <div class="col-lg-8">

                <section class="moon-glass-panel p-0 mb-4 overflow-hidden position-relative">
                    <div class="row g-0 position-relative z-1">

                        <div class="col-md-5 p-4 p-md-5 text-center text-md-start moon-border-end d-flex flex-column justify-content-center">
                            <span class="text-uppercase fw-bold fs-7 mb-3 d-block moon-text-readable" style="letter-spacing: 1px;">
                                Faza w dniu: <time class="text-white" th:datetime="${selectedDate}" th:text="${#temporals.format(selectedDate, 'dd.MM.yyyy')}">01.01.2026</time>
                            </span>

                            <div class="d-flex align-items-center justify-content-center justify-content-md-start gap-3 mb-3">

                                <div class="moon-emoji-huge" aria-hidden="true" th:classappend="${todayGlobal.isSuperMoon} ? 'supermoon-glow' : ''" th:switch="${todayGlobal.phaseEnum.name()}">
                                    <span th:case="'NEW_MOON'">ğŸŒ‘</span>
                                    <span th:case="'WAXING_CRESCENT'">ğŸŒ’</span>
                                    <span th:case="'FIRST_QUARTER'">ğŸŒ“</span>
                                    <span th:case="'WAXING_GIBBOUS'">ğŸŒ”</span>
                                    <span th:case="'FULL_MOON'">ğŸŒ•</span>
                                    <span th:case="'WANING_GIBBOUS'">ğŸŒ–</span>
                                    <span th:case="'LAST_QUARTER'">ğŸŒ—</span>
                                    <span th:case="'WANING_CRESCENT'">ğŸŒ˜</span>
                                    <span th:case="*">ğŸŒ•</span>
                                </div>

                                <div>
                                    <h2 class="fs-4 fs-md-3 fw-black text-white mb-1 lh-sm" th:text="${todayGlobal.phaseMoonPl}">PeÅ‚nia</h2>
                                    <span class="fs-7 text-brand-green fw-bold text-glow-green d-block" th:if="${todayGlobal.isSuperMoon}">
                                        SuperksiÄ™Å¼yc âš¡
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-7 p-4 p-md-5 moon-condition-bg d-flex flex-column justify-content-center">
                            <div class="row g-4">
                                <div class="col-6">
                                    <div class="d-flex align-items-center gap-2 mb-1">
                                        <i data-lucide="sun" class="text-brand-green" style="width: 18px;"></i>
                                        <span class="moon-text-readable fs-7 text-uppercase fw-bold">OÅ›wietlenie</span>
                                    </div>
                                    <span class="fs-3 fw-bold text-white" th:text="${todayGlobal.illuminationPct} + '%'">99.8%</span>
                                </div>
                                <div class="col-6">
                                    <div class="d-flex align-items-center gap-2 mb-1">
                                        <i data-lucide="clock" class="text-brand-green" style="width: 18px;"></i>
                                        <span class="moon-text-readable fs-7 text-uppercase fw-bold">Wiek ksiÄ™Å¼yca</span>
                                    </div>
                                    <span class="fs-3 fw-bold text-white">
                                        <span th:text="${todayGlobal.moonAgeDays}">14.5</span>
                                        <span class="fs-6 moon-text-readable fw-normal">dni</span>
                                    </span>
                                </div>
                                <div class="col-12 mt-2">
                                    <div class="d-inline-flex align-items-center gap-2 px-3 py-2 rounded-3 w-100 border text-center text-sm-start"
                                         th:classappend="'bg-dark text-white border-dark-subtle'">
                                        <i data-lucide="fish" style="width: 20px; flex-shrink: 0;" th:classappend="${todayActivity.cssClass}"></i>
                                        <span class="fw-bold fs-6" th:classappend="${todayActivity.cssClass}" th:text="'Ocena algorytmu: ' + ${todayActivity.description}">AktywnoÅ›Ä‡: DoskonaÅ‚a</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="moon-glass-panel p-3 p-md-4">
                    <header class="d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4 pb-3 border-bottom border-dark-subtle gap-3">
                        <a th:href="@{/ksiezyc(year=${prevMonth.year}, month=${prevMonth.monthValue}, date=${selectedDate}, lat=${lat}, lon=${lon}, name=${locationName})}" class="btn moon-nav-btn w-100 w-sm-auto order-2 order-sm-1" aria-label="Poprzedni miesiÄ…c">
                            <i data-lucide="chevron-left"></i> Poprzedni
                        </a>

                        <th:block th:with="currM=${prevMonth.plusMonths(1).monthValue}, currY=${prevMonth.plusMonths(1).year}">
                            <h2 class="fs-4 text-white fw-bold mb-0 text-uppercase text-center order-1 order-sm-2" style="letter-spacing: 1px;">
                                <span th:if="${currM == 1}">StyczeÅ„</span>
                                <span th:if="${currM == 2}">Luty</span>
                                <span th:if="${currM == 3}">Marzec</span>
                                <span th:if="${currM == 4}">KwiecieÅ„</span>
                                <span th:if="${currM == 5}">Maj</span>
                                <span th:if="${currM == 6}">Czerwiec</span>
                                <span th:if="${currM == 7}">Lipiec</span>
                                <span th:if="${currM == 8}">SierpieÅ„</span>
                                <span th:if="${currM == 9}">WrzesieÅ„</span>
                                <span th:if="${currM == 10}">PaÅºdziernik</span>
                                <span th:if="${currM == 11}">Listopad</span>
                                <span th:if="${currM == 12}">GrudzieÅ„</span>
                                <span th:text="${currY}"></span>
                            </h2>
                        </th:block>

                        <a th:href="@{/ksiezyc(year=${nextMonth.year}, month=${nextMonth.monthValue}, date=${selectedDate}, lat=${lat}, lon=${lon}, name=${locationName})}" class="btn moon-nav-btn w-100 w-sm-auto order-3 order-sm-3" aria-label="NastÄ™pny miesiÄ…c">
                            NastÄ™pny <i data-lucide="chevron-right"></i>
                        </a>
                    </header>

                    <div class="moon-calendar-grid">
                        <div class="calendar-header">Pon</div>
                        <div class="calendar-header">Wto</div>
                        <div class="calendar-header">Åšro</div>
                        <div class="calendar-header">Czw</div>
                        <div class="calendar-header">PiÄ…</div>
                        <div class="calendar-header">Sob</div>
                        <div class="calendar-header">Nie</div>

                        <th:block th:each="day : ${calendarDays}">
                            <div class="calendar-day empty" th:if="${day.isEmpty}"></div>

                            <div class="calendar-day p-0" th:unless="${day.isEmpty}"
                                 th:classappend="${day.date.isEqual(selectedDate)} ? 'active-selected' : (${day.isToday} ? 'active-today' : '')">

                                <a th:href="@{/ksiezyc(date=${day.date}, year=${currentMonthName != null ? day.date.year : null}, month=${currentMonthName != null ? day.date.monthValue : null}, lat=${lat}, lon=${lon}, name=${locationName})}"
                                   class="calendar-day-link w-100 px-2 py-1" th:aria-label="'Kalendarz na ' + ${day.date}">
                                    <span class="day-number mt-1" th:text="${day.dayOfMonth}">1</span>

                                    <div class="day-moon-emoji" aria-hidden="true" th:switch="${day.phase.name()}">
                                        <span th:case="'NEW_MOON'">ğŸŒ‘</span>
                                        <span th:case="'WAXING_CRESCENT'">ğŸŒ’</span>
                                        <span th:case="'FIRST_QUARTER'">ğŸŒ“</span>
                                        <span th:case="'WAXING_GIBBOUS'">ğŸŒ”</span>
                                        <span th:case="'FULL_MOON'">ğŸŒ•</span>
                                        <span th:case="'WANING_GIBBOUS'">ğŸŒ–</span>
                                        <span th:case="'LAST_QUARTER'">ğŸŒ—</span>
                                        <span th:case="'WANING_CRESCENT'">ğŸŒ˜</span>
                                    </div>

                                    <div class="solunar-bar" th:classappend="'level-' + ${day.activity.level}"></div>
                                </a>
                            </div>
                        </th:block>
                    </div>

                    <div class="d-flex justify-content-center justify-content-md-end mt-4 gap-2 gap-md-3 flex-wrap">
                        <span class="fs-8 moon-text-readable d-flex align-items-center gap-1"><div class="solunar-dot" style="background: #ef4444;"></div> B. SÅ‚abe</span>
                        <span class="fs-8 moon-text-readable d-flex align-items-center gap-1"><div class="solunar-dot" style="background: #f59e0b;"></div> SÅ‚abe</span>
                        <span class="fs-8 moon-text-readable d-flex align-items-center gap-1"><div class="solunar-dot" style="background: #0ea5e9;"></div> Åšrednie</span>
                        <span class="fs-8 moon-text-readable d-flex align-items-center gap-1"><div class="solunar-dot" style="background: #3b82f6;"></div> Dobre</span>
                        <span class="fs-8 moon-text-readable d-flex align-items-center gap-1"><div class="solunar-dot" style="background: var(--brand-green); box-shadow: 0 0 10px var(--brand-green);"></div> DoskonaÅ‚e</span>
                    </div>
                </section>

            </div>

            <aside class="col-lg-4">
                <article class="moon-glass-panel p-4 h-100 d-flex flex-column"
                         th:style="${todayActivity.name() == 'EXCELLENT'} ? 'border-color: rgba(46, 204, 113, 0.4); box-shadow: 0 0 20px rgba(46,204,113,0.1);' : ''">

                    <div class="mb-4 d-flex align-items-center gap-2 border-bottom border-dark-subtle pb-3"
                         th:classappend="${todayActivity.name() == 'EXCELLENT'} ? 'text-brand-green' : 'text-white'">
                        <i data-lucide="brain-circuit" style="width: 24px; height: 24px;"></i>
                        <h2 class="fs-5 fw-bold mb-0">Szansa na brania</h2>
                    </div>

                    <div class="moon-knowledge-item mb-4" th:if="${todayActivity.name() == 'EXCELLENT'}">
                        <h3 class="fs-5 text-brand-green fw-bold mb-2">ğŸ”¥ Pakuj wÄ™dki, to ten czas!</h3>
                        <p class="fs-7 text-brand-green fw-bold mb-3 bg-brand-green-subtle px-2 py-1 rounded d-inline-block">DzieÅ„ na bicie Å¼yciowych rekordÃ³w.</p>
                        <p class="moon-text-readable fs-7 lh-lg mb-0">
                            Faza <strong th:text="${todayGlobal.phaseMoonPl}">PeÅ‚nia / NÃ³w</strong> generuje skrajne wychylenia pÅ‚ywowe. ZwierzÄ™ta instynktownie odczuwajÄ… zmianÄ™ ciÅ›nienia hydrostatycznego i Å¼erujÄ… "na zapas". Okienka Å¼erowe sÄ… dÅ‚ugie i niezwykle intensywne.
                        </p>
                        <ul class="verdict-target-list fs-7 mt-3">
                            <li>
                                <i data-lucide="swords" class="text-danger flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">DrapieÅ¼niki:</strong>
                                    <strong>DrapieÅ¼niki wychodzÄ… pÅ‚ycej, bo drobnica teÅ¼ siÄ™ rusza.</strong> W nocy absolutnym hitem sÄ… pÅ‚ytkie blaty (do 1-2m). UÅ¼ywaj duÅ¼ych, odznaczajÄ…cych siÄ™ od spodu przynÄ™t. W czasie Nowiu przenieÅ› Å‚owienie na wczesny Å›wit.
                                </div>
                            </li>
                            <li>
                                <i data-lucide="wheat" class="text-warning flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">BiaÅ‚oryb (Karp):</strong>
                                    Ryby karpiowate odkurzajÄ… dno. To idealny moment na obfite <strong>nÄ™cenie dywanowe</strong>. Nie bÃ³j siÄ™ wrzuciÄ‡ do wody grubego ziarna.
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="moon-knowledge-item mb-4" th:if="${todayActivity.name() == 'GOOD'}">
                        <h3 class="fs-5 text-primary fw-bold mb-2">ğŸ“ˆ Woda nabiera Å¼ycia</h3>
                        <p class="fs-7 text-primary fw-bold mb-3 px-2 py-1 rounded d-inline-block" style="background: rgba(59, 130, 246, 0.1);">Jeden z najlepszych okresÃ³w caÅ‚ego miesiÄ…ca.</p>
                        <p class="moon-text-readable fs-7 lh-lg mb-0">
                            KsiÄ™Å¼yc w fazie przybywajÄ…cej dziaÅ‚a na ryby jak naturalny stymulator. Z kaÅ¼dym dniem ryby stajÄ… siÄ™ coraz bardziej pewne siebie i agresywnie przemieszczajÄ… siÄ™ w poszukiwaniu poÅ¼ywienia.
                        </p>
                        <ul class="verdict-target-list fs-7 mt-3">
                            <li>
                                <i data-lucide="swords" class="text-danger flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">DrapieÅ¼niki:</strong>
                                    Dobry czas na <em>power fishing</em>. UÅ¼ywaj przynÄ™t o mocnej fali hydroakustycznej (woblery z grzechotkÄ…, cykady). ProwadÅº przynÄ™tÄ™ szybciej niÅ¼ zwykle, bÄ™dÄ… jÄ… goniÄ‡.
                                </div>
                            </li>
                            <li>
                                <i data-lucide="wheat" class="text-warning flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">BiaÅ‚oryb:</strong>
                                    WpadajÄ… w rytm Å¼erowy przed peÅ‚niÄ…. Åšwietnie sprawdzi siÄ™ taktyka punktowego, regularnego donÄ™cania. Celuj w sÅ‚odkie/owocowe aromaty.
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="moon-knowledge-item mb-4" th:if="${todayActivity.name() == 'AVERAGE'}">
                        <h3 class="fs-5 text-info fw-bold mb-2">âš–ï¸ Stabilizacja i standard</h3>
                        <p class="fs-7 text-info fw-bold mb-3 px-2 py-1 rounded d-inline-block" style="background: rgba(14, 165, 233, 0.1);">DzieÅ„ na wÄ™dkarskie rzemiosÅ‚o, a nie rekordy iloÅ›ciowe.</p>
                        <p class="moon-text-readable fs-7 lh-lg mb-0">
                            Fazy kwadry oznaczajÄ… rÃ³wnowagÄ™. Ryby zachowujÄ… siÄ™ zgodnie z dobowymi schematami. WpÅ‚yw ksiÄ™Å¼yca schodzi na drugi plan. TwÃ³j sukces zaleÅ¼y dziÅ› w 100% od umiejÄ™tnoÅ›ci czytania wody i pogody.
                        </p>
                        <ul class="verdict-target-list fs-7 mt-3">
                            <li>
                                <i data-lucide="swords" class="text-danger flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">DrapieÅ¼niki:</strong>
                                    Skup siÄ™ bezwzglÄ™dnie na <strong>ZÅ‚otych Godzinach</strong> (Å›wit i zmierzch). W ciÄ…gu dnia szukaj ryb gÅ‚Ä™biej, z uÅ¼yciem stonowanych kolorÃ³w. Klasyczny opad z podbicia to faworyt.
                                </div>
                            </li>
                            <li>
                                <i data-lucide="wheat" class="text-warning flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">BiaÅ‚oryb:</strong>
                                    Kluczowa jest perfekcyjna prezentacja. Zastosuj zbalansowane przynÄ™ty (Wafters/BaÅ‚wanek), by uÅ‚atwiÄ‡ zassanie. Woreczki PVA sprawdzÄ… siÄ™ lepiej niÅ¼ luÅºne sypanie.
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="moon-knowledge-item mb-4" th:if="${todayActivity.name() == 'POOR'}">
                        <h3 class="fs-5 text-warning fw-bold mb-2">ğŸ“‰ Zwalniamy tempo</h3>
                        <p class="fs-7 text-warning fw-bold mb-3 px-2 py-1 rounded d-inline-block" style="background: rgba(245, 158, 11, 0.1);">To nie dzieÅ„ na iloÅ›Ä‡, a na cierpliwoÅ›Ä‡ i kombinowanie.</p>
                        <p class="moon-text-readable fs-7 lh-lg mb-0">
                            Faza ubywajÄ…ca wycisza Å¼ycie pod wodÄ…. Grawitacja sÅ‚abnie. Ryby sÄ… ospaÅ‚e, bardzo ostroÅ¼ne i nierzadko "przejedzone" po peÅ‚ni. MogÄ… ignorowaÄ‡ standardowo podany pokarm.
                        </p>
                        <ul class="verdict-target-list fs-7 mt-3">
                            <li>
                                <i data-lucide="swords" class="text-danger flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">DrapieÅ¼niki:</strong>
                                    Finezja. Drastycznie <strong>zmniejsz rozmiar przynÄ™t</strong> (np. z 12 do 7 cm) i zejdÅº z gramatury. Stosuj dÅ‚ugi zwis, wleczenie po dnie (Carolina Rig) lub jaskÃ³Å‚ki pozbawione wÅ‚asnej pracy.
                                </div>
                            </li>
                            <li>
                                <i data-lucide="wheat" class="text-warning flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">BiaÅ‚oryb:</strong>
                                    CaÅ‚kowicie zrezygnuj z grubej zanÄ™ty â€“ natychmiast "zabijesz" Å‚owisko. PrzejdÅº na smuÅ¼Ä…cÄ… zanÄ™tÄ™ ziemistÄ…, najcieÅ„sze przypony i mikro-haczyki z jednym ziarnkiem lub pinkÄ….
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="moon-knowledge-item mb-4" th:if="${todayActivity.name() == 'VERY_POOR'}">
                        <h3 class="fs-5 text-danger fw-bold mb-2">ğŸ›‹ï¸ Pustynia w wodzie</h3>
                        <p class="fs-7 text-danger fw-bold mb-3 px-2 py-1 rounded d-inline-block" style="background: rgba(239, 68, 68, 0.1);">DzieÅ„ testujÄ…cy psychikÄ™. Sukcesem bÄ™dzie pojedyncza ryba.</p>
                        <p class="moon-text-readable fs-7 lh-lg mb-0">
                            Najtrudniejszy, "martwy" okres w cyklu. ZwierzÄ™ta wodne wpadajÄ… w gÅ‚Ä™boki letarg, chowajÄ… siÄ™ w zawadach i przyklejajÄ… do dna. Wymagane sÄ… stalowe nerwy i nieszablonowe myÅ›lenie.
                        </p>
                        <ul class="verdict-target-list fs-7 mt-3">
                            <li>
                                <i data-lucide="swords" class="text-danger flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">DrapieÅ¼niki:</strong>
                                    Brania z gÅ‚odu nie wystÄ…piÄ… â€“ musisz wymusiÄ‡ <strong>atak irytacyjny/terytorialny</strong>. TaÅ„cz przynÄ™tÄ… w miejscu przed samym pyskiem ryby. UÅ¼ywaj skrajnie jaskrawych kolorÃ³w (Firetiger) i atraktorÃ³w.
                                </div>
                            </li>
                            <li>
                                <i data-lucide="wheat" class="text-warning flex-shrink-0 mt-1" style="width: 20px; height: 20px;"></i>
                                <div class="moon-text-readable">
                                    <strong class="text-white">BiaÅ‚oryb:</strong>
                                    NÄ™cenie wstÄ™pne to sabotaÅ¼. ÅÃ³w punktowo na tzw. "zÅ‚odzieja". Stosuj maleÅ„kie przynÄ™ty Fluo o ekstremalnie mocnej, nienaturalnej nucie zapachowej (np. Kwas MasÅ‚owy), ktÃ³ra wyrwie rybÄ™ z apatii.
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="mt-auto bg-dark bg-opacity-50 p-3 rounded-3 border border-dark-subtle" th:if="${todayActivity.name() != 'EXCELLENT' and nextBestDay != null}">
                        <span class="d-block moon-text-readable fs-8 text-uppercase fw-bold mb-2">NajbliÅ¼sze okienko braÅ„ (Eldorado):</span>
                        <div class="d-flex align-items-center gap-3">
                            <div class="d-flex align-items-center justify-content-center flex-shrink-0" style="width: 48px; height: 48px;" th:switch="${nextBestDay.phaseEnum.name()}">
                                <span class="fs-1 m-0 p-0" style="line-height: 1;" th:case="'NEW_MOON'">ğŸŒ‘</span>
                                <span class="fs-1 m-0 p-0" style="line-height: 1;" th:case="'WAXING_CRESCENT'">ğŸŒ’</span>
                                <span class="fs-1 m-0 p-0" style="line-height: 1;" th:case="'FIRST_QUARTER'">ğŸŒ“</span>
                                <span class="fs-1 m-0 p-0" style="line-height: 1;" th:case="'WAXING_GIBBOUS'">ğŸŒ”</span>
                                <span class="fs-1 m-0 p-0" style="line-height: 1;" th:case="'FULL_MOON'">ğŸŒ•</span>
                                <span class="fs-1 m-0 p-0" style="line-height: 1;" th:case="'WANING_GIBBOUS'">ğŸŒ–</span>
                                <span class="fs-1 m-0 p-0" style="line-height: 1;" th:case="'LAST_QUARTER'">ğŸŒ—</span>
                                <span class="fs-1 m-0 p-0" style="line-height: 1;" th:case="'WANING_CRESCENT'">ğŸŒ˜</span>
                            </div>
                            <div>
                                <h4 class="fs-5 fw-bold text-brand-green mb-0" th:text="${#temporals.format(nextBestDay.calculationDate, 'dd.MM.yyyy')}">12.10.2026</h4>
                                <span class="fs-7 text-white opacity-75" th:text="${nextBestDay.phaseMoonPl}">NÃ³w</span>
                            </div>
                        </div>
                    </div>
                </article>
            </aside>

        </div>

        <section class="moon-glass-panel p-4 p-lg-5 mb-5 border-brand-green-subtle position-relative overflow-hidden">

            <div class="moon-glow glow-green-bottom" style="opacity: 0.05;"></div>

            <header class="row align-items-center mb-4 pb-3 border-bottom border-dark-subtle position-relative z-1">
                <div class="col-lg-5 mb-3 mb-lg-0">
                    <h3 class="fs-4 text-white fw-bold mb-1">
                        SÅ‚oÅ„ce i KsiÄ™Å¼yc dla: <span class="text-brand-green" th:text="${locationName}">Warszawa</span>
                    </h3>
                    <p class="moon-text-readable fs-7 mb-0">Dane dla dnia: <span class="fw-bold" th:text="${#temporals.format(selectedDate, 'dd.MM.yyyy')}"></span></p>
                </div>
                <div class="col-lg-7">

                    <form id="geocoding-form" class="row g-2 align-items-center m-0 w-100" aria-label="Wyszukiwarka danych solunarnych">
                        <div class="col-12 col-md-5 position-relative p-0 pe-md-1 mb-2 mb-md-0">
                            <i data-lucide="map-pin" class="position-absolute text-brand-green" style="left: 14px; top: 50%; transform: translateY(-50%); width: 20px; z-index: 5;"></i>
                            <input type="text" id="city-input" placeholder="Wpisz miasto (np. KrakÃ³w)" th:value="${locationName}" required
                                   class="form-control bg-dark text-white border-dark-subtle w-100"
                                   style="padding-left: 42px; height: 48px; border-radius: 8px; box-shadow: none;" aria-label="Wpisz miasto">
                        </div>

                        <div class="col-12 col-md-4 p-0 px-md-1 mb-2 mb-md-0">
                            <input type="date" id="date-input" th:value="${selectedDate}" required
                                   class="form-control bg-dark text-white border-dark-subtle w-100 text-center"
                                   style="height: 48px; border-radius: 8px; box-shadow: none;" aria-label="Wybierz datÄ™">
                        </div>

                        <div class="col-12 col-md-3 p-0 ps-md-1">
                            <button type="submit" class="btn w-100" id="search-btn"
                                    style="background: var(--brand-green); color: #000; font-weight: 700; height: 48px; border-radius: 8px; border: none;">
                                Zastosuj
                            </button>
                        </div>
                    </form>

                </div>
            </header>

            <div class="row g-3 position-relative z-1" th:if="${stationData != null}">
                <div class="col-12 mt-2 mb-2">
                    <h4 class="text-white fs-6 fw-bold d-flex align-items-center gap-2"><i data-lucide="sun" class="text-brand-green"></i> Parametry SÅ‚oÅ„ca</h4>
                </div>

                <div class="col-6 col-md-4">
                    <div class="local-data-box text-center">
                        <i data-lucide="sunrise" class="text-brand-green mb-2" style="width: 24px; height: 24px;"></i>
                        <span class="d-block moon-text-readable fs-8 text-uppercase fw-bold mb-1">WschÃ³d SÅ‚oÅ„ca</span>
                        <span class="fs-4 fw-bold text-white" th:text="${stationData.sunrise != null ? #temporals.format(stationData.sunrise, 'HH:mm') : '--:--'}">05:42</span>
                    </div>
                </div>
                <div class="col-6 col-md-4">
                    <div class="local-data-box text-center">
                        <i data-lucide="sunset" class="text-brand-green mb-2" style="width: 24px; height: 24px;"></i>
                        <span class="d-block moon-text-readable fs-8 text-uppercase fw-bold mb-1">ZachÃ³d SÅ‚oÅ„ca</span>
                        <span class="fs-4 fw-bold text-white" th:text="${stationData.sunset != null ? #temporals.format(stationData.sunset, 'HH:mm') : '--:--'}">19:15</span>
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="local-data-box text-center">
                        <i data-lucide="timer" class="text-white mb-2" style="width: 24px; height: 24px;"></i>
                        <span class="d-block moon-text-readable fs-8 text-uppercase fw-bold mb-1">DÅ‚ugoÅ›Ä‡ Dnia</span>
                        <span class="fs-4 fw-bold text-brand-green text-glow-green"
                              th:text="${stationData.dayLengthSec != null ? (stationData.dayLengthSec / 3600) + 'h ' + ((stationData.dayLengthSec % 3600) / 60) + 'm' : '--'}">13h 33m</span>
                    </div>
                </div>

                <div class="col-12 mt-4 mb-2 border-top border-dark-subtle pt-3">
                    <h4 class="text-white fs-6 fw-bold d-flex align-items-center gap-2"><i data-lucide="moon" class="text-brand-green"></i> Parametry KsiÄ™Å¼yca</h4>
                </div>

                <div class="col-6 col-md-3">
                    <div class="local-data-box text-center">
                        <i data-lucide="arrow-up-right" class="text-brand-green mb-2" style="width: 24px; height: 24px;"></i>
                        <span class="d-block moon-text-readable fs-8 text-uppercase fw-bold mb-1">WschÃ³d KsiÄ™Å¼yca</span>
                        <span class="fs-4 fw-bold text-white" th:text="${stationData.moonrise != null ? #temporals.format(stationData.moonrise, 'HH:mm') : '--:--'}">18:42</span>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="local-data-box text-center">
                        <i data-lucide="chevrons-up" class="text-white mb-2" style="width: 24px; height: 24px;"></i>
                        <span class="d-block moon-text-readable fs-8 text-uppercase fw-bold mb-1">GÃ³rowanie (Transit)</span>
                        <span class="fs-4 fw-bold text-brand-green text-glow-green" th:text="${stationData.transit != null ? #temporals.format(stationData.transit, 'HH:mm') : '--:--'}">00:15</span>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="local-data-box text-center">
                        <i data-lucide="arrow-down-right" class="text-brand-green mb-2" style="width: 24px; height: 24px;"></i>
                        <span class="d-block moon-text-readable fs-8 text-uppercase fw-bold mb-1">ZachÃ³d KsiÄ™Å¼yca</span>
                        <span class="fs-4 fw-bold text-white" th:text="${stationData.moonset != null ? #temporals.format(stationData.moonset, 'HH:mm') : '--:--'}">06:30</span>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="local-data-box text-center">
                        <i data-lucide="mountain-snow" class="text-brand-green mb-2" style="width: 24px; height: 24px;"></i>
                        <span class="d-block moon-text-readable fs-8 text-uppercase fw-bold mb-1">WysokoÅ›Ä‡ KsiÄ™Å¼yca</span>
                        <span class="fs-4 fw-bold text-white" th:text="${stationData.maxAltitude != null ? stationData.maxAltitude + 'Â°' : '--'}">45.2Â°</span>
                    </div>
                </div>
            </div>

            <div class="row position-relative z-1" th:if="${stationData == null}">
                <div class="col-12 py-4 text-center">
                    <p class="text-white opacity-75 mb-0">Nie znaleÅºliÅ›my precyzyjnych danych sÅ‚oÅ„ca i ksiÄ™Å¼yca dla tego miasta. UÅ¼yj innej lokalizacji.</p>
                </div>
            </div>

        </section>

        <div class="moon-glass-panel p-4 mb-5 border-brand-green-subtle position-relative overflow-hidden" style="background: rgba(46, 204, 113, 0.05);">
            <div class="d-flex flex-column flex-md-row align-items-md-center gap-4 position-relative z-1">
                <div class="flex-shrink-0 text-center">
                    <i data-lucide="cloud-lightning" class="text-brand-green" style="width: 64px; height: 64px;"></i>
                </div>
                <div class="flex-grow-1">
                    <h2 class="fs-4 text-white fw-bold mb-2">âš ï¸ PamiÄ™taj: KsiÄ™Å¼yc to tylko 10-20% sukcesu!</h2>
                    <p class="moon-text-readable fs-6 mb-3">
                        Nawet najlepsza "faza Eldorado" na nic siÄ™ zda, jeÅ›li zignorujesz warunki atmosferyczne. To <strong>zmiany pogody sÄ… TOP #1</strong> decydujÄ…cym o udanym Å¼erowaniu. Zawsze zwracaj uwagÄ™ na:
                    </p>
                    <div class="d-flex flex-wrap gap-2 mb-3">
                        <span class="badge bg-dark border border-dark-subtle text-white p-2 d-flex align-items-center gap-2"><i data-lucide="thermometer" class="text-brand-green" style="width: 14px;"></i> Skoki temperatury</span>
                        <span class="badge bg-dark border border-dark-subtle text-white p-2 d-flex align-items-center gap-2"><i data-lucide="wind" class="text-brand-green" style="width: 14px;"></i> Wiatr</span>
                        <span class="badge bg-dark border border-dark-subtle text-white p-2 d-flex align-items-center gap-2"><i data-lucide="gauge" class="text-brand-green" style="width: 14px;"></i> CiÅ›nienie</span>
                    </div>
                    <p class="fs-5 fw-bold text-brand-green mb-0 d-inline-flex align-items-center gap-2 bg-dark bg-opacity-50 px-3 py-2 border border-brand-green-subtle rounded-3">
                        ğŸ‘‰ ZÅ‚ota zasada wÄ™dkarza: "ZÅ‚y ksiÄ™Å¼yc + dobra pogoda = Å›wietne brania!"
                    </p>
                </div>
            </div>
        </div>

        <section class="moon-glass-panel p-4 p-lg-5 mb-5 position-relative overflow-hidden" aria-labelledby="seo-section-title">
            <div class="position-absolute top-0 end-0 translate-middle-y" style="width: 300px; height: 300px; background: radial-gradient(circle, rgba(46, 204, 113, 0.05) 0%, transparent 70%); border-radius: 50%;"></div>

            <div class="row align-items-center position-relative z-1">
                <div class="col-lg-5 mb-4 mb-lg-0">
                    <h2 id="seo-section-title" class="fs-2 fw-bold text-white mb-3 lh-sm">
                        Jak liczymy fazy i oceniamy <br><span class="text-brand-green">szanse na branie?</span>
                    </h2>
                    <p class="moon-text-readable fs-6 lh-lg mb-0">
                        Nasz wÄ™dkarski kalendarz solunarny nie opiera siÄ™ na wrÃ³Å¼bach, a na solidnych danych astronomicznych zdefiniowanych dla Twojego rejonu i powiÄ…zanych z potwierdzonÄ… wiedzÄ… na temat zachowaÅ„ organizmÃ³w wodnych.
                    </p>
                </div>

                <div class="col-lg-7">
                    <article class="bg-dark bg-opacity-50 p-4 rounded-4 border border-dark-subtle mb-3">
                        <h3 class="fs-6 text-white fw-bold mb-2 d-flex align-items-center gap-2">
                            <i data-lucide="database" class="text-brand-green" style="width: 18px; height: 18px;"></i> Precyzyjne dane astronomiczne
                        </h3>
                        <p class="moon-text-readable fs-7 mb-0">
                            Silnik analizuje nie tylko sam wyglÄ…d tarczy ksiÄ™Å¼yca. Obliczamy m.in. <strong>procent iluminacji, odlegÅ‚oÅ›Ä‡ od Ziemi oraz wysokoÅ›Ä‡ gÃ³rowania</strong> (tzw. tranzyt), dopasowujÄ…c wyniki do podanych przez Ciebie wspÃ³Å‚rzÄ™dnych geograficznych i korelujÄ…c je z dÅ‚ugoÅ›ciÄ… i fazami sÅ‚onecznymi.
                        </p>
                    </article>

                    <article class="bg-dark bg-opacity-50 p-4 rounded-4 border border-dark-subtle">
                        <h3 class="fs-6 text-white fw-bold mb-2 d-flex align-items-center gap-2">
                            <i data-lucide="activity" class="text-brand-green" style="width: 18px; height: 18px;"></i> Teoria grawitacyjna braÅ„
                        </h3>
                        <p class="moon-text-readable fs-7 mb-0">
                            Ocena braÅ„ bazuje na fakcie, Å¼e woda i jej mieszkaÅ„cy ulegajÄ… mikropÅ‚ywom. Fazom odciÄ™tych caÅ‚kowicie od sÅ‚oÅ„ca (nÃ³w) lub o maksymalnym oÅ›wietleniu (peÅ‚nia) towarzyszÄ… okresy nasilonego instynktownego poszukiwania pokarmu przez ryby przed powrotem ciÅ›nienia do normy.
                        </p>
                    </article>
                </div>
            </div>
        </section>

    </div>
</main>

<footer th:replace="~{fragments/footer :: footer}"></footer>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        lucide.createIcons();

        const form = document.getElementById('geocoding-form');
        if (form) {
            form.addEventListener('submit', async function(e) {
                e.preventDefault();

                const inputVal = document.getElementById('city-input').value;
                const dateVal = document.getElementById('date-input').value;
                const btn = document.getElementById('search-btn');
                const originalText = btn.textContent;

                btn.textContent = 'Szukam...';
                btn.style.opacity = '0.7';

                try {
                    const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(inputVal)}&countrycodes=pl&limit=1`);
                    const data = await response.json();

                    if (data && data.length > 0) {
                        const lat = data[0].lat;
                        const lon = data[0].lon;

                        const rawName = data[0].name || inputVal;
                        const cleanName = rawName.split(',')[0].trim();

                        const urlParams = new URLSearchParams(window.location.search);
                        urlParams.set('lat', lat);
                        urlParams.set('lon', lon);
                        urlParams.set('name', cleanName);
                        if (dateVal) {
                            urlParams.set('date', dateVal);
                        }

                        window.location.search = urlParams.toString();
                    } else {
                        alert("Nie znaleziono takiej lokalizacji. SprÃ³buj wpisaÄ‡ innÄ… nazwÄ™ (np. najbliÅ¼sze duÅ¼e miasto).");
                        resetBtn();
                    }
                } catch (error) {
                    console.error("BÅ‚Ä…d podczas wyszukiwania:", error);
                    alert("WystÄ…piÅ‚ problem z poÅ‚Ä…czeniem. SprÃ³buj ponownie za chwilÄ™.");
                    resetBtn();
                }

                function resetBtn() {
                    btn.textContent = originalText;
                    btn.style.opacity = '1';
                }
            });
        }
    });
</script>
</body>
</html>